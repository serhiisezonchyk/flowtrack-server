import{r,R as P,u as q,A as H,a as T,j as o,N as $,S as z,I as M,B as D,L as J,b as K,c as m,i as Q,t as U,s as W}from"./index-9kwa141l.js";function X(e={}){const{nonce:t,onScriptLoadSuccess:i,onScriptLoadError:c}=e,[f,a]=r.useState(!1),l=r.useRef(i);l.current=i;const d=r.useRef(c);return d.current=c,r.useEffect(()=>{const n=document.createElement("script");return n.src="https://accounts.google.com/gsi/client",n.async=!0,n.defer=!0,n.nonce=t,n.onload=()=>{var s;a(!0),(s=l.current)===null||s===void 0||s.call(l)},n.onerror=()=>{var s;a(!1),(s=d.current)===null||s===void 0||s.call(d)},document.body.appendChild(n),()=>{document.body.removeChild(n)}},[t]),f}const F=r.createContext(null);function Y({clientId:e,nonce:t,onScriptLoadSuccess:i,onScriptLoadError:c,children:f}){const a=X({nonce:t,onScriptLoadSuccess:i,onScriptLoadError:c}),l=r.useMemo(()=>({clientId:e,scriptLoadedSuccessfully:a}),[e,a]);return P.createElement(F.Provider,{value:l},f)}function Z(){const e=r.useContext(F);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function ee(e){var t;return(t=e==null?void 0:e.clientId)!==null&&t!==void 0?t:e==null?void 0:e.client_id}const oe={large:40,medium:32,small:20};function te({onSuccess:e,onError:t,useOneTap:i,promptMomentNotification:c,type:f="standard",theme:a="outline",size:l="large",text:d,shape:n,logo_alignment:s,width:p,locale:h,click_listener:j,containerProps:g,...v}){const w=r.useRef(null),{clientId:y,scriptLoadedSuccessfully:O}=Z(),k=r.useRef(e);k.current=e;const b=r.useRef(t);b.current=t;const B=r.useRef(c);return B.current=c,r.useEffect(()=>{var L,C,_,I,N,E,G,A,R;if(O)return(_=(C=(L=window==null?void 0:window.google)===null||L===void 0?void 0:L.accounts)===null||C===void 0?void 0:C.id)===null||_===void 0||_.initialize({client_id:y,callback:u=>{var x;if(!(u!=null&&u.credential))return(x=b.current)===null||x===void 0?void 0:x.call(b);const{credential:S,select_by:V}=u;k.current({credential:S,clientId:ee(u),select_by:V})},...v}),(E=(N=(I=window==null?void 0:window.google)===null||I===void 0?void 0:I.accounts)===null||N===void 0?void 0:N.id)===null||E===void 0||E.renderButton(w.current,{type:f,theme:a,size:l,text:d,shape:n,logo_alignment:s,width:p,locale:h,click_listener:j}),i&&((R=(A=(G=window==null?void 0:window.google)===null||G===void 0?void 0:G.accounts)===null||A===void 0?void 0:A.id)===null||R===void 0||R.prompt(B.current)),()=>{var u,x,S;i&&((S=(x=(u=window==null?void 0:window.google)===null||u===void 0?void 0:u.accounts)===null||x===void 0?void 0:x.id)===null||S===void 0||S.cancel())}},[y,O,i,f,a,l,d,n,s,p,h]),P.createElement("div",{...g,ref:w,style:{height:oe[l],...g==null?void 0:g.style}})}const re=()=>{var h,j;const e=q(),{isAuth:t,login:i,googleSignIn:c}=r.useContext(H),f=async g=>{var w;const v=m.loading("Please wait...");try{await i(g),m.update(v,{render:"Login succeed",type:"success",isLoading:!1,autoClose:2e3}),e("/my-boards")}catch(y){Q(y)?m.update(v,{render:`${(w=y.response)==null?void 0:w.data.error}`,type:"error",isLoading:!1,autoClose:2e3}):m.update(v,{render:"Something went wrong! Try later.",type:"error",isLoading:!1,autoClose:2e3})}},a=async g=>{const v=m.loading("Please wait...");try{await c(g.credential),m.update(v,{render:"Google Sign-In succeed",type:"success",isLoading:!1,autoClose:2e3}),e("/my-boards")}catch{m.update(v,{render:"Google Sign-In failed",type:"error",isLoading:!1,autoClose:2e3})}},l=()=>{m.error("Google Sign-In failed")},{register:d,handleSubmit:n,formState:s}=T({defaultValues:{login:"",password:""},resolver:U(W)}),{errors:p}=s;return t?o.jsx($,{to:"/",replace:!0}):o.jsxs("div",{className:"h-full flex justify-center items-center",children:[o.jsx(z,{title:"Sign In | FlowTrack",description:"Sign in to access your account and enjoy our services.",name:"Sign In",type:"form"}),o.jsxs("div",{className:"mx-auto flex w-full flex-col justify-center space-y-6 sm:w-[350px]",children:[o.jsxs("div",{className:"flex flex-col space-y-2 text-center",children:[o.jsx("h1",{className:"text-2xl font-semibold tracking-tight",children:"Login"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter your email and password below to login your account"})]}),o.jsxs("form",{onSubmit:n(f),className:"flex flex-col px-2 sm:px-0",children:[o.jsx(M,{...d("login"),placeholder:"Login",label:"Login",id:"login",autoCapitalize:"none",autoComplete:"email",autoCorrect:"off",errorMessage:(h=p.login)==null?void 0:h.message}),o.jsx(M,{...d("password"),placeholder:"Password",type:"password",id:"password",autoCorrect:"off",label:"Password",errorMessage:(j=p.password)==null?void 0:j.message}),o.jsxs("div",{className:"w-full flex flex-row mt-6 gap-2",children:[o.jsx(D,{type:"submit",className:"flex-1",variant:"secondary",children:"Sign In"}),o.jsx(Y,{clientId:"336159141005-qn0fj0rd5f6bpoeqf07cshh95iscpdj0.apps.googleusercontent.com",children:o.jsx(te,{onSuccess:a,onError:l,type:"icon"})})]})]}),o.jsxs("div",{className:"text-center flex flex-col gap-2",children:[o.jsxs("div",{className:"flex items-center justify-center",children:[o.jsx("div",{className:"border-t border-gray-300 flex-grow mr-3"}),o.jsx("div",{children:"Or"}),o.jsx("div",{className:"border-t border-gray-300 flex-grow ml-3"})]}),o.jsx(J,{to:"/sign-up",className:K({variant:"outline"}),children:"Create new account..."})]})]})]})};export{re as default};
